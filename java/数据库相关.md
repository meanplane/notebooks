## mybatis注解

### 1 基本curd

#### @Select

```java
@Select("select * from user")
List<User> findAll();


@Select("select * from user  where id=#{id} ")
User findById(Integer userId);

@Select("select count(*) from user ")
int findTotalUser();
```

#### 模糊查询

```java
//@Select("select * from user where username like #{username} ")
@Select("select * from user where username like '%${value}%' ")
List<User> findUserByName(String username);

@Test
public  void testFindByName(){
    //List<User> users = userDao.findUserByName("%mybatis%");
    List<User> users = userDao.findUserByName("mybatis");
    for(User user : users){
        System.out.println(user);
    }
}
```



#### @Insert

```java
@Insert("insert into user(username,address,sex,birthday)values(#{username},#{address},#{sex},#{birthday})")
void saveUser(User user);
```

#### @Update

```java
@Update("update user set username=#{username},sex=#{sex},birthday=#{birthday},address=#{address} where id=#{id}")
void updateUser(User user);
```

#### @Delete

```java
@Delete("delete from user where id=#{id} ")
void deleteUser(Integer userId);
```



### 2 复杂关系映射

####  @Results

> **代替的是标签<resultMap>**
>
> 该注解中可以使用单个@Result 注解，也可以使用@Result 集合
> @Results（{@Result（），@Result（）}）或@Results（@Result（））

```java
@Select("select * from user")
@Results(id="userMap",value={
    @Result(id=true,column = "id",property = "userId"),
    @Result(column = "username",property = "userName"),
    @Result(column = "address",property = "userAddress"),
    @Result(column = "sex",property = "userSex"),
    @Result(column = "birthday",property = "userBirthday"),
    @Result(property = "accounts",column = "id",
            many = @Many(select = "com.itheima.dao.IAccountDao.findAccountByUid",
                         fetchType = FetchType.LAZY))
})
List<User> findAll();

// id 定义一个Results,便于以后用
// 可以用
@ResultMap("userMap")
```

#### @Result

```java
id 是否是主键字段
column 数据库的列名
property 需要装配的属性名
one 需要使用的@One 注解（@Result（one=@One）（）））
many 需要使用的@Many 注解（@Result（many=@many）（）））
```

#### @One

```java
@Result(property = "accounts",column = "id",
        one = @One(select = "com.itheima.dao.IAccountDao.findAccountByUid",
                         fetchType = FetchType.LAZY))
```

#### @Many