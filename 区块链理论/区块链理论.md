

### 区块链是什么

##### **一种分布式数据库(本质)**

##### 一种网络底层协议(抽象)

它是一种共识协议,基于这种协议,可以在其上开发出各种应用, 这些应用在每一时刻都保存一条最长的, 最具权威的, 共同认可的数据记录, 并遵循共同认可的机制进行无需中间权威仲裁的, 直接的, 点对点的交互信息.

TCP/IP: 数据层, 网络层, 传输层, 应用层

**区块链:  数据层,  网络层,  ==共识层,  激励层,  合约层==,  应用层**



---



### 区块链的特点

##### 	去中心化

​		所有参与其中的网络节点共同维护,  无需中心节点调控

##### 	不可篡改

​		整个链条按照时间顺序和哈希指针链接起来,环环相扣

##### 	匿名性

​		私钥和地址是使用网络的所有条件, 无需身份验证

##### 	可溯源

​		所有写入区块的数据需多方验证, 公开透明



---



### 区块链的发展

##### 	V1.0数字货币(可编程货币)

​		特点:	TPS低, 比特币处理7比交易, 基于栈编程,  图灵不完备(无循环语句,  不能实现复杂编程)

##### 	V2.0智能合同(可编程金融)

​		区块链2.0是可编程金融,  是经济,  市场和金融领域的区块链应用,  例如股票, 债券,  期货,  贷款,  抵押,  产权,  		智能财产和智能合约.

​		代表:	==以太坊(ETH)==  小蚁(NEO)	比原(BTM)

​		特点:	处理速度加快,  ==图灵完备==(可以用代码实现各种复杂的逻辑)

##### 	V3.0高级智能合同(可编程社会)

​		区块链与社会,  区块链与各个行业融合:  物联网,  存储,  游戏,  区块链+

​		代表:  柚子(EOS) ,  墨客(MOAC)

​		特点:  处理速度快,  可达到商用级别



---



### 区块链协议层

##### 	整体图示

![](D:\notebooks\区块链理论\pic\1562556845(1).png)

##### 	数据层

​		区块链数据,  链式结构,  哈希函数,  Merkle树,  非对称加密,  时间戳

​		(需要突破的就是区块容量问题)

##### 	网络层

​		P2P网络,  传播机制,  验证机制(自组网络)

##### 	共识层

###### 		共识机制

> 共识机制是指可以使所有节点对某一种状态达成一致的方式,有共识机制去中心化才有意义, 才具备可信度,  否则知识数据共享,  目前主流的共识机制有:  POW	POS	DPOS	PBFT 等.

###### 		POW

| Pow   (proof of work,工作量证明)                             |
| ------------------------------------------------------------ |
| 比特币在Block的生成过程中使用了POW机制,  一个符合要求的Block Hash由N个前导零 构成,  零的个数取决于网络的难度值,  要得到合理的Block Hash需要经过大量尝试计算,  计算时间取决于机器的哈希运算速度,  当某个节点提供出一个合理的Block Hash值,  说明该节点确实经过了大量的尝试计算,  当然,  并不能得出计算的绝对值,  因为寻找合理hash 是一个概率事件.  当节点拥有占全网N% 算力时,  该节点即有 n/100 的概率挖到矿 |

```
 特点:
	算一道很难的谜题, 系统给予挖矿奖励
	多劳多得(社会主义)

 优点:
    1. 所有节点均可参与,记账权公平的分派到每个节点,  去中心化
    2. 多劳多得,  矿工积极性高
    3. 安全性高,  欺诈成本高,  如果能够欺诈成功,  那么做诚实节点收益更大

 缺点:
    1. 主流矿池垄断严重,  存在51%算力攻击风险
    2. 浪费资源严重(2018 年底消耗全球0.5%电量)
    3. 持币人没有话语权,  算力决定一切
    4. 网络性能低,  共识时间长

 项目:
  比特币,  以太坊,  比原链
```



###### 		POS

| POS   (proof  of stake,  股权证明)                           |
| ------------------------------------------------------------ |
| 类似于财产储存在银行,  这种模式会根据你持有数字货币的量和时间,  分配给你相应的利息.  举个例子,  就是一个根据你持有货币的量和时间,  给你发利息的一个制度,  在股权证明POS 模式下,  有一个名词叫 币龄,  每个币每天产生 1 币龄, 比如你持有100个币,总共持有了30天, 那么此时你的币龄就为3000, 这个时候,如果你发现了一个POS区块, 你的币龄就会被清空为0 ,  你每被清空 365币龄, 你将会从区块中获得0.05 个币的利息(假定利息可以理解为年利率  5%),  那么在这个案例中,  利息 = 3000 * 5% / 365 = 0.41 个币, 持币有利息.  具体的利息不同币种不一样. |

```
特点:
  不挖矿, 依靠币龄( 币持有量 * 持有天数 )决定记账权,  利息即为奖励,  记账后币龄清零
  按钱分配, 钱生钱 (资本主义)

优点:
  1. 在一定程度上缩短了 共识达成的时间
  2. 节约资源
  3. 放作弊, 币龄越大, 获得记账权几率越大,  避免51% 攻击, 因为攻击会使自己权益受损

缺点:
  数字货币过于集中化, 富人 越来越 富, 散户参与积极性低

项目:
  ADA等
```



###### 		DPOS

| DPOS  (Delegated Proof  Of  Stake,  委托权益证明)            |
| ------------------------------------------------------------ |
| 让每一个持有币的人进行投票,  由此产生n个代表,  我们可以将其理解为 n 个超级节点或者矿池,  这 n 个超级节点彼此的权利是完全相等的 .  从某种角度来看,  DPOS 有点像是议会制度或 人民代表大会制度.  如果代表不能履行他们的职责(当轮到他们时, 没能生成区块), 他们会被除名,  网络会选出新的超级节点来取代他们,  DPOS的出现最主要还是因为矿机的产生,  大量的算力在不了解也不关心比特币的人身上,  类似演唱会的黄牛,  大量囤票而丝毫不关心演唱会的内容. |

```
特点:
  不挖矿,每年按比例增发代币,  奖励超级节点

优点:
  高效,  扩展性强

缺点:
  21个节点太少, 非去中心化, 而是多中心化

项目:
  EOS
```



###### 		POW+POS混合

|                          |
| ------------------------ |
| 让挖矿和持币人均参与记账 |

```
项目:	以太坊,  HCASH,  MOAC
```



###### 		Ripple共识机制

###### 		小蚁NEO共识机制(DBFT)

###### 		常见区块链项目共识机制

​			![](D:\notebooks\区块链理论\pic\1562573554(1).png)

##### 	激励层

​		发行机制,  分配机制

##### 	合约层

###### 		智能合约介绍

​		

| 智能合约 (smart contract)                                    |
| ------------------------------------------------------------ |
| 这个术语至少可以追溯到1995年,  是由多产的跨领域法律学者 尼克 · 萨博(Nick  Szabo)提出来的 . 他发表在自己的网站的几篇文章中提到了智能合约的理念. 他的定义如下: |
| 一个智能合约是一套以数字形式定义的承诺(promises) , 包括合约参与方可以在上面执行这些承诺的协议. |

```
本质:	数字化合同
特点:	代码代替人仲裁和执行合同,  同时能够触发支付

举例:
	假设你和我对明天的天气进行打赌,  我打赌明天是晴天,  但是你打赌是雨天. 双方同意输的一方必须给赢的一方100 美元. 那么, 我们如何才能够做到这一点, 并且确保输掉的一方不会耍赖?

传统解决办法:
	1.基于信任
		仅适用于可信任的人, 对于陌生人, 不适用
	2.签一个法律协议
		通过合法途径强制协议执行的成本,要比这个赌约的价值高的多
	3.请一个中间人帮忙
		中间人把钱卷走了怎么办
```

==普通合约:==

![](D:\notebooks\区块链理论\pic\1562576502(1).png)



==智能合约:==

![智能合约](D:\notebooks\区块链理论\pic\1562574497(1).png)

​		`整个步骤包括:	构建-> 存储 -> 执行`

 1. 构建( **本地构建** )

    > 智能合约由区块链内的多个用户共同参与制定,  可用于用户之间的任何交易行为.  协议中明确了双方的权利和义务,  开发人员将这些权利和义务以电子化的方式进行编程,  代码中包含会触发自动执行的条件.

 2. 存储( **链上存储** )

    一旦编码完成,  这份智能合约就被上传到区块链网络上,  即全网验证节点都会接收到你和对方合约.

 3. 执行( **EVM中执行** )

    a.   智能合约会定期检查是否存在相关事件和触发条件,满足条件的事件会推送到验证的队列中.  天气情况这个数据就成了该合约的触发条件.

    b.   区块链上的 验证节点 先对事件进行签名验证, 以确保其有效性;  等大多数验证节点对该事件达成共识后,  智能合约将成功执行,  并通知用户.

    ```
    注: 外部输入来源于 ORACLE (中文翻译:"预言机"), 一种可信的实体,通过签名引入外部状态信息,从而允许确定的智能合约对外部不确定的数据做出反应, 预言机具有不可篡改,服务稳定,可审计等特点.第三方预言机发送一笔区块链交易, 交易中附带需要的数据,嵌入区块,同步给所有节点, 从而用于智能合约触发.
    ```

    ==以太坊智能合约模型:==

    ![](D:\notebooks\区块链理论\pic\1562576652(1).png)

    ###### 智能合约的作用

    ​	(...)

    ---

##### 	应用层





### 区块链按应用场景分类

##### 	公有链	

``` 
特点:
	所有人都可以随时进入和退出, 每个节点平等, 都有权交易和记账, 属于开放式
代表:
	比特币, 以太坊, EOS, NEO, 量子链, 比原链, 
```

##### 	联盟链

```
特点:
	仅部分人参与,加入和退出需要授权, 选定某些节点为记账人, 其他人可以交易, 但无记账权, 属于半封闭式.
代表:
	R3CEV
	全球40多个银行成立的联盟组织,2017年7月成立,共享区块链技术.
	IBM farbric 项目
	Linux基金会发起的超级账本(HyperLedger)项目,2015年成立,farbric是子项目.
```

##### 	私有链

```
特点:
	公司内部使用,可实现更好的权限控制:管理和审计,属于封闭式.
代表:
	以太坊可以定制自己的私有链, 商用区块链定制
```

### 

### 区块链相关概念

##### 	矿工

​		由运行比特币客户端的节点充当, 竞争记账权, 从而获得奖励

##### 	矿机

​		cpu挖矿->Gpu挖矿->FPGA挖矿->ASIC挖矿(专业矿机)

##### 	挖矿

​		这种从无到有产生货币的方式与传统的开采矿石的过程很像,所以称为挖矿

```
矿场:
	集中矿机, 设备的场所
矿池:
	一个软件,矿场和普通矿工接入,矿池负责打包,接入的设备负责挖矿,按照贡献算力的比例来分配收益
	(主流的矿池: 鱼池,蚁池,币网,国池等)
```

##### 	算力

```
1P = 1024T, 1T = 1024G, 1G = 1024M, 1M = 1024K
算力即计算能力,表明一个矿工挖矿能力, 算力越大算出哈希值的概率越高
单位为 hash/s,每秒计算Hash的次数,例如 14T算力的矿机,每秒计算哈希次数为 1.4 * 10^13,
目前算力为 4.3*10^7 TH/s 即每秒运算次数为: 4.3 * 10^20 (全网算力)
```

##### 	分叉

​		代码升级时 不同社区意见发生分歧时的结果, 重大bug修复时会分叉

###### 		软分叉

###### 			旧节点接收新协议产生的区块,毫无感知,新老协议共同维护一条链

​		